lvgl:
  on_boot:
    then:
      - script.execute: get_light_amount_btn
      - lvgl.obj.update:
          id: ${light_widget_name_1}_btn
          shadow_color: color_misty_blue

  top_layer:
    widgets:
      - obj:
          id: light_select_widget
          hidden: true
          x: -60
          y: -60
          width: 450
          height: 165
          align: top_left
          pad_all: 0
          bg_color: color_slate_blue_gray
          bg_opa: cover
          border_opa: transp
          border_width: 0
          shadow_color: color_black
          shadow_spread: 5
          shadow_width: 12
          scrollable: false
          radius: 60
          widgets:
            - obj:
                id: light_select_widget_cont
                x: -15
                y: -8
                width: 360
                height: 90
                align: bottom_right
                bg_opa: transp
                border_opa: transp
                border_width: 0
                pad_all: 0
                layout:
                  type: flex
                  flex_align_main: space_evenly
                  flex_align_cross: center
                  flex_align_track: center
                widgets:
                  - obj:
                      id: ${light_widget_name_1}_btn
                      width: 72
                      height: 72
                      pad_all: 0
                      radius: 45
                      bg_opa: transp
                      border_opa: transp
                      shadow_width: 8
                      shadow_spread: 2
                      shadow_color: color_black
                      pressed:
                        bg_color: color_black
                        shadow_width: 6
                      widgets:
                        - label:
                            id: ${light_widget_name_1}_icon
                            align: center
                            text_font: mdi_icons_36
                            text_color: color_misty_blue
                            text: "${light_icon_1}"
                      on_press:
                        - lvgl.page.show: ${light_widget_name_1}_light_page
                        - lvgl.obj.update:
                            id: ${light_widget_name_1}_btn
                            shadow_color: color_misty_blue
                        - lvgl.obj.update:
                            id: ${light_widget_name_2}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_3}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_4}_btn
                            shadow_color: color_black

                  - obj:
                      id: ${light_widget_name_2}_btn
                      width: 72
                      height: 72
                      pad_all: 0
                      radius: 45
                      bg_opa: transp
                      border_opa: transp
                      shadow_width: 8
                      shadow_spread: 2
                      shadow_color: color_black
                      pressed:
                        bg_color: color_black
                        shadow_width: 6
                      widgets:
                        - label:
                            id: ${light_widget_name_2}_icon
                            align: center
                            text_font: mdi_icons_36
                            text_color: color_misty_blue
                            text: "${light_icon_2}"
                      on_press:
                        - lvgl.page.show: ${light_widget_name_2}_light_page
                        - lvgl.obj.update:
                            id: ${light_widget_name_1}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_2}_btn
                            shadow_color: color_misty_blue
                        - lvgl.obj.update:
                            id: ${light_widget_name_3}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_4}_btn
                            shadow_color: color_black

                  - obj:
                      id: ${light_widget_name_3}_btn
                      width: 72
                      height: 72
                      pad_all: 0
                      radius: 45
                      bg_opa: transp
                      border_opa: transp
                      shadow_width: 8
                      shadow_spread: 2
                      shadow_color: color_black
                      pressed:
                        bg_color: color_black
                        shadow_width: 6
                      widgets:
                        - label:
                            id: ${light_widget_name_3}_icon
                            align: center
                            text_font: mdi_icons_36
                            text_color: color_misty_blue
                            text: "${light_icon_3}"
                      on_press:
                        - lvgl.page.show: ${light_widget_name_3}_light_page
                        - lvgl.obj.update:
                            id: ${light_widget_name_1}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_2}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_3}_btn
                            shadow_color: color_misty_blue
                        - lvgl.obj.update:
                            id: ${light_widget_name_4}_btn
                            shadow_color: color_black

                  - obj:
                      id: ${light_widget_name_4}_btn
                      width: 72
                      height: 72
                      pad_all: 0
                      radius: 45
                      bg_opa: transp
                      border_opa: transp
                      shadow_width: 8
                      shadow_spread: 2
                      shadow_color: color_black
                      pressed:
                        bg_color: color_black
                        shadow_width: 6
                      widgets:
                        - label:
                            id: ${light_widget_name_4}_icon
                            align: center
                            text_font: mdi_icons_36
                            text_color: color_misty_blue
                            text: "${light_icon_4}"
                      on_press:
                        - lvgl.page.show: ${light_widget_name_4}_light_page
                        - lvgl.obj.update:
                            id: ${light_widget_name_1}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_2}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_3}_btn
                            shadow_color: color_black
                        - lvgl.obj.update:
                            id: ${light_widget_name_4}_btn
                            shadow_color: color_misty_blue

script:
  - id: get_light_amount_btn
    then:
      - lambda: |-
          int lights = ${lights_amount};
          
          if (lights >= 2) {
            lv_obj_set_width(id(light_select_widget), 285);
            lv_obj_set_width(id(light_select_widget_cont), 195);
            lv_obj_clear_flag(id(${light_widget_name_1}_btn), LV_OBJ_FLAG_HIDDEN);
            lv_obj_clear_flag(id(${light_widget_name_2}_btn), LV_OBJ_FLAG_HIDDEN);
          } else {
            lv_obj_add_flag(id(${light_widget_name_1}_btn), LV_OBJ_FLAG_HIDDEN);
            lv_obj_add_flag(id(${light_widget_name_2}_btn), LV_OBJ_FLAG_HIDDEN);
          }
          
          if (lights >= 3) {
            lv_obj_set_width(id(light_select_widget), 368);
            lv_obj_set_width(id(light_select_widget_cont), 278);
            lv_obj_clear_flag(id(${light_widget_name_3}_btn), LV_OBJ_FLAG_HIDDEN);
          } else {
            lv_obj_add_flag(id(${light_widget_name_3}_btn), LV_OBJ_FLAG_HIDDEN);
          }
          
          if (lights >= 4) {
            lv_obj_set_width(id(light_select_widget), 450);
            lv_obj_set_width(id(light_select_widget_cont), 360);
            lv_obj_clear_flag(id(${light_widget_name_4}_btn), LV_OBJ_FLAG_HIDDEN);
          } else {
            lv_obj_add_flag(id(${light_widget_name_4}_btn), LV_OBJ_FLAG_HIDDEN);
          }
